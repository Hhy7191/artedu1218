<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>나만의 아트보드게임</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .font-serif { font-family: serif; }
        
        /* 실습용 캔버스 스타일 */
        #drawingCanvas {
            background-color: #ffffff;
            touch-action: none;
            border: 1px solid #e5e7eb;
        }
        .cursor-brush { cursor: crosshair; }
        .cursor-text { cursor: text; }
        .cursor-grab { cursor: grab !important; }
        .template-thumbnail {
            width: 40px; height: 40px;
            object-fit: cover; cursor: pointer;
            transition: transform 0.1s; border-radius: 6px;
            border: 2px solid transparent;
        }
        .template-thumbnail.active { border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // 아이콘 컴포넌트
        const Icon = ({ name, className = "" }) => {
            const ref = useRef(null);
            useEffect(() => {
                if (lucide.icons[name]) {
                    const icon = lucide.createIcons({
                        icons: { [name]: lucide.icons[name] },
                        attrs: { class: className, 'stroke-width': 1.5 }
                    });
                }
            }, [name, className]);
            return <i ref={ref} data-lucide={name} className={className}></i>;
        };

        // 이미지 연상 실습 컴포넌트 (업로드된 파일 기반)
        const ImageAssociationStudio = () => {
            const canvasRef = useRef(null);
            const [mode, setMode] = useState('brush');
            const [color, setColor] = useState('#000000');
            const [size, setSize] = useState(5);
            const [history, setHistory] = useState([]);
            const [currentTpl, setCurrentTpl] = useState('https://i.postimg.cc/kg20RfFr/1.png');

            const templates = [
                { name: '로르샤흐 1', url: 'https://i.postimg.cc/kg20RfFr/1.png' }, 
                { name: '로르샤흐 2', url: 'https://i.postimg.cc/T3BZVgCY/2.png' }, 
                { name: '로르샤흐 3', url: 'https://i.postimg.cc/Jn3V40Ng/3.png' }, 
                { name: '로르샤흐 4', url: 'https://i.postimg.cc/rmGXFsGm/4.png' }, 
                { name: '로르샤흐 5', url: 'https://i.postimg.cc/nzKbcrKf/5.png' }
            ];

            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                canvas.width = 600;
                canvas.height = 450;
                loadTemplate(currentTpl);
            }, []);

            const loadTemplate = (url) => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                const img = new Image();
                img.crossOrigin = 'Anonymous';
                img.onload = () => {
                    ctx.fillStyle = '#ffffff';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    const scale = 0.5;
                    const sw = canvas.width * scale;
                    const sh = canvas.height * scale;
                    ctx.drawImage(img, (canvas.width - sw)/2, (canvas.height - sh)/2, sw, sh);
                };
                img.src = url;
            };

            const handleDraw = (e) => {
                if (mode !== 'brush') return;
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;

                if (e.type === 'mousedown' || e.type === 'touchstart') {
                    ctx.beginPath();
                    ctx.moveTo(x, y);
                    canvas.isDrawing = true;
                } else if ((e.type === 'mousemove' || e.type === 'touchmove') && canvas.isDrawing) {
                    ctx.lineTo(x, y);
                    ctx.strokeStyle = color;
                    ctx.lineWidth = size;
                    ctx.lineCap = 'round';
                    ctx.stroke();
                } else {
                    canvas.isDrawing = false;
                }
            };

            return (
                <div className="space-y-6">
                    <div className="bg-slate-50 p-4 rounded-2xl flex gap-4 overflow-x-auto">
                        {templates.map(t => (
                            <img 
                                key={t.url} 
                                src={t.url} 
                                className={`template-thumbnail ${currentTpl === t.url ? 'active' : ''}`}
                                onClick={() => { setCurrentTpl(t.url); loadTemplate(t.url); }}
                            />
                        ))}
                    </div>
                    <div className="flex flex-col md:flex-row gap-6">
                        <div className="flex flex-row md:flex-col gap-3 bg-slate-50 p-4 rounded-2xl">
                            <button onClick={() => setMode('brush')} className={`p-3 rounded-xl ${mode === 'brush' ? 'bg-slate-900 text-white' : 'bg-white'}`}><Icon name="paintbrush" /></button>
                            <input type="color" value={color} onChange={(e) => setColor(e.target.value)} className="w-10 h-10 rounded-lg cursor-pointer" />
                            <input type="range" min="1" max="20" value={size} onChange={(e) => setSize(e.target.value)} className="w-24" />
                        </div>
                        <div className="flex-1 bg-slate-100 rounded-2xl p-4 flex justify-center items-center overflow-hidden">
                            <canvas 
                                ref={canvasRef} 
                                id="drawingCanvas"
                                onMouseDown={handleDraw} onMouseMove={handleDraw} onMouseUp={handleDraw}
                                onTouchStart={handleDraw} onTouchMove={handleDraw} onTouchEnd={handleDraw}
                                className="max-w-full h-auto shadow-inner rounded-lg"
                            />
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [currentPage, setCurrentPage] = useState('main');

            const menuItems = [
                { id: 'image-association', title: '이미지 연상', description: '로르샤흐 이미지 위에서 상상을 펼쳐보세요.', icon: 'palette' },
                { id: 'art-history', title: '미술사 이해', description: '거장들의 발자취를 따라가는 기록.', icon: 'history' },
                { id: 'elements-principles', title: '조형 요소와 원리', description: '기초가 만드는 무한한 가능성.', icon: 'layout' },
                { id: 'creative-studio', title: '창의력 발전소', description: '새로운 관점을 제안하는 실험실.', icon: 'lightbulb' }
            ];

            const MainScreen = () => (
                <div className="min-h-screen bg-white text-slate-900 px-6 py-20 flex flex-col items-center">
                    <header className="w-full max-w-5xl mb-20">
                        <h1 className="text-xs font-bold tracking-[0.3em] text-slate-300 uppercase mb-4">Art Board Game</h1>
                        <h2 className="text-5xl md:text-6xl font-light tracking-tight leading-tight">예술적 영감을 깨우는 <br /><span className="font-serif italic text-slate-600">새로운 여정</span></h2>
                    </header>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-px bg-slate-100 max-w-5xl w-full border-y border-slate-100">
                        {menuItems.map((item) => (
                            <button key={item.id} onClick={() => setCurrentPage(item.id)} className="group bg-white p-12 flex flex-col items-start text-left hover:bg-slate-50 transition-all duration-500">
                                <Icon name={item.icon} className="mb-10 w-8 h-8 text-slate-800" />
                                <h3 className="text-xl font-medium mb-2">{item.title}</h3>
                                <p className="text-slate-400 font-light text-sm max-w-[240px] mb-8">{item.description}</p>
                                <div className="mt-auto flex items-center text-[10px] font-bold tracking-widest uppercase text-slate-300 group-hover:text-slate-900">
                                    Start <Icon name="arrow-right" className="ml-2 w-3 h-3" />
                                </div>
                            </button>
                        ))}
                    </div>
                </div>
            );

            const SubPage = ({ item }) => (
                <div className="min-h-screen bg-white text-slate-900 p-8">
                    <nav className="max-w-5xl mx-auto mb-16">
                        <button onClick={() => setCurrentPage('main')} className="group flex items-center text-[10px] font-bold tracking-widest uppercase text-slate-400 hover:text-slate-900">
                            <Icon name="arrow-left" className="mr-2 w-3 h-3" /> Back to Studio
                        </button>
                    </nav>
                    <main className="max-w-5xl mx-auto">
                        <h2 className="text-4xl font-light mb-2">{item.title}</h2>
                        <div className="h-px w-12 bg-slate-900 mb-12"></div>
                        
                        {item.id === 'image-association' ? (
                            <ImageAssociationStudio />
                        ) : (
                            <div className="aspect-video bg-slate-50 rounded-3xl border border-slate-100 flex flex-col items-center justify-center text-slate-400">
                                <Icon name={item.icon} className="w-12 h-12 mb-4 opacity-20" />
                                <p className="font-light tracking-widest uppercase text-[10px]">Preparing Experience...</p>
                            </div>
                        )}
                    </main>
                </div>
            );

            const activeItem = menuItems.find(item => item.id === currentPage);
            return currentPage === 'main' ? <MainScreen /> : <SubPage item={activeItem} />;
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>